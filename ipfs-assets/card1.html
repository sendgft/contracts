<!DOCTYPE html>
<html>
  <head>
    <!-- HEAD_PLACEHOLDER -->
    <script type="text/javascript">
      const refresh = (gift) => {
        const spacer = '<p>&nbsp;</p>'
        let html = `<p>From: ${gift.sender}</p>`
        html += `${spacer}<p>Date: ${gift.datetime}</p>`
        if (gift.message) {
          html += `${spacer}<p>${gift.message}</p>`
        }
        let assetsHtml = ''
        if (gift.native) {
          assetsHtml += `<p>${gift.native.symbol} ${gift.native.amount}</p>`
        }
        if (gift.erc20 && gift.erc20.length) {
          for (let token of gift.erc20) {
            assetsHtml += `<p>${token.symbol} ${token.amount}</p>`
          }
        }

        if (assetsHtml) {
          html += `${spacer}<p>Received:</p>${assetsHtml}`
        }

        document.getElementById("main").innerHTML = html
      }

      window.addEventListener("message", (event) => {
        const { host } = new URL(event.origin)
        if (host.startsWith('localhost:') || host.startsWith('127.0.0.1:') || host === 'gft.xyz' || host.endsWith('.gft.xyz')) {
          if (event.data.gift) {
            console.log(event.data.gift)
            refresh(event.data.gift)
          }
        } else {
          throw new Error(`Bad origin: ${event.origin}`)
        }
      }, false);      
     </script>
    <style media="all">
      body {
        background-color: #EF3F6B;
        color: #fff;
        font-family: Verdana, Arial, sans-serif;
        font-size: 16px;
        margin: 0;
        padding: 0;
      }
    
      main {
        text-align: center;
        position: absolute;
        width: 100vw;
        top: 50%;
      }
    </style>
  </head>
  <body>
    <main id="main"></main>
  </body>
</html>